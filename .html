<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Fictional Downtown Toronto - Walkaround</title>
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>

<script>
// ---- BASIC SCENE ----
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb); // sky blue

const camera = new THREE.PerspectiveCamera(
  75, window.innerWidth / window.innerHeight, 0.1, 1000
);

const renderer = new THREE.WebGLRenderer();
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// ---- GROUND ----
const groundGeometry = new THREE.PlaneGeometry(500, 500);
const groundMaterial = new THREE.MeshPhongMaterial({ color: 0x444444 });
const ground = new THREE.Mesh(groundGeometry, groundMaterial);
ground.rotation.x = -Math.PI / 2;
scene.add(ground);

// ---- LIGHTING ----
const light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(10, 20, 10);
scene.add(light);

// ---- SIMPLE BUILDINGS (FICTIONAL) ----
function addBuilding(x, z, w, h, d, color) {
  const geo = new THREE.BoxGeometry(w, h, d);
  const mat = new THREE.MeshPhongMaterial({ color: color });
  const building = new THREE.Mesh(geo, mat);
  building.position.set(x, h / 2, z);
  scene.add(building);
}

addBuilding(20, 0, 15, 40, 15, 0x6e7dff); // "Sky Tower" in blue
addBuilding(-20, -30, 20, 60, 20, 0xffcc00); // "Golden Plaza" in yellow
addBuilding(40, -20, 25, 50, 25, 0xff5733); // "Sunrise Building" in orange

// ---- NPC PLACEHOLDER (FICTIONAL CHARACTERS) ----
function addNPC(x, z, color, name) {
  const geo = new THREE.BoxGeometry(2, 5, 2);
  const mat = new THREE.MeshPhongMaterial({ color: color });
  const npc = new THREE.Mesh(geo, mat);
  npc.position.set(x, 2.5, z);
  npc.name = name; // Name NPC for interaction later
  scene.add(npc);
}

addNPC(5, -5, 0xffccaa, "Alex - Coffee Lover");
addNPC(-10, 10, 0x99ff99, "Jordan - Street Artist");
addNPC(15, 20, 0xcc99ff, "Chris - Office Worker");

// ---- "FICTIONAL GUN" (NON-VIOLENT OBJECT) ----
const gunGeometry = new THREE.CylinderGeometry(0.2, 0.5, 2);
const gunMaterial = new THREE.MeshBasicMaterial({ color: 0x333333 });
const gun = new THREE.Mesh(gunGeometry, gunMaterial);
gun.rotation.x = Math.PI / 2;  // Align gun along camera view
gun.position.set(0, 1, 5);  // Positioned in front of the camera
scene.add(gun);

// ---- PLAYER MOVEMENT ----
let keys = {};
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

camera.position.set(0, 3, 10);

function updateMovement() {
  const speed = 0.2;
  if (keys["w"]) camera.position.z -= speed;
  if (keys["s"]) camera.position.z += speed;
  if (keys["a"]) camera.position.x -= speed;
  if (keys["d"]) camera.position.x += speed;
}

// ---- GUN INTERACTION ----
function useGun() {
  // Basic action when the gun is "used" (non-violent)
  const raycaster = new THREE.Raycaster();
  const mouse = new THREE.Vector2();
  raycaster.update();
  raycaster.ray.origin.copy(camera.position);
  raycaster.ray.direction.set(0, -1, 0);  // Shoot downwards

  const intersects = raycaster.intersectObjects(scene.children);
  if (intersects.length > 0) {
    const object = intersects[0].object;
    if (object.name && object.name !== "Ground") {
      alert("You interacted with " + object.name + "!");
    }
  }
}

// ---- MAIN LOOP ----
function animate() {
  requestAnimationFrame(animate);
  updateMovement();
  if (keys[" "]) useGun();  // Spacebar to interact with NPCs

  renderer.render(scene, camera);
}

animate();

// ---- RESIZE HANDLER ----
window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

</script>

</body>
</html>
